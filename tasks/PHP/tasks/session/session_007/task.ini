[Info]

Variant=0

Text="<p>Написать функцию PercentageOfBrowserUsage(), которая находит процентное соотношение иcпользования браузеров Opera или Firefox. Функция выводи строку
'Firefox - $percentageUsedFirefox Opera - $percentageUsedOpera', где $percentageUsedFirefox и $percentageUsedOpera - процентное соотношение использованя 
браузеров. При решении задачи учесть, что функция session_start() уже была вызвана.</p>"

Difficulty=4

Topic="Задачи на сеансы"
TopicId=254

Author="zexel"

Solver="PHP"

[Solution]
ExemplaryQuery='function PercentageOfBrowserUsage() {
			$agentsArr = array(
			"OPR"		=> "Opera",
			"Firefox"	=> "Firefox"
		);

$currentAgent = "";
        $totalCount = 1;
		foreach($agentsArr as $agentAbbr => $agent)
			if(stripos($_SERVER["HTTP_USER_AGENT"], $agentAbbr) !== false)
				$currentAgent = $agent;
			
			$sessionsFile = "sessions.txt";
			touch($sessionsFile);
			
			$info = unserialize(file_get_contents($sessionsFile));
			
			if(is_array($info))
				foreach($info as $sid)
					foreach($sid as $browser)
						$totalCount += $browser["count"];
				
			if(isset($info[session_id()][$currentAgent]))
				$info[session_id()][$currentAgent]["count"]++;
			
			else 
				$info[session_id()][$currentAgent]=[
					"count" => 1,
				];
			
			if(!isset($info[session_id()]["Opera"]))
				$info[session_id()]["Opera"] =
				[
					"count" => 0,
					"percentage" => "0%"
				];
			
			if(!isset($info[session_id()]["Firefox"]))
				$info[session_id()]["Firefox"] =
				[
					"count" => 0,
					"percentage" => "0%"
				];
			
			foreach($info as &$sid)
				foreach($sid as &$browser) 
					$browser["percentage"] = (round($browser["count"] / $totalCount, 2) * 100)."%";
			
            unset($browser);
			unset($sid);
			
			file_put_contents($sessionsFile, serialize($info));
			
		return "Firefox - ".$info[session_id()]["Firefox"]["percentage"]." Opera - ".$info[session_id()]["Opera"]["percentage"];	
		}'



[DataBase]
TaskId=2371
GroupTaskId=1520
